package friendgoods.vidic.com.generalframework.activity.fragment;import android.content.Context;import android.content.Intent;import android.content.res.Resources;import android.os.Bundle;import android.support.annotation.NonNull;import android.support.annotation.Nullable;import android.support.design.widget.TabLayout;import android.support.v4.view.PagerAdapter;import android.support.v4.view.ViewPager;import android.text.TextUtils;import android.util.TypedValue;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.ImageView;import android.widget.LinearLayout;import android.widget.TextView;import java.lang.reflect.Field;import java.util.ArrayList;import butterknife.BindView;import butterknife.ButterKnife;import friendgoods.vidic.com.generalframework.R;import friendgoods.vidic.com.generalframework.activity.LoginActivity;import friendgoods.vidic.com.generalframework.touzi.EmailActivity;import friendgoods.vidic.com.generalframework.touzi.TouziAdapter;import friendgoods.vidic.com.generalframework.touzi.TouziGengduoFragment;import friendgoods.vidic.com.generalframework.touzi.TouziGongyuFragment;import friendgoods.vidic.com.generalframework.touzi.TouziJiudianFragment;import friendgoods.vidic.com.generalframework.touzi.TouziMinsuFragment;import friendgoods.vidic.com.generalframework.touzi.TouziNewFragment;import friendgoods.vidic.com.generalframework.touzi.TouziSousuoActivity;import friendgoods.vidic.com.generalframework.touzi.TouziYugaoFragment;import friendgoods.vidic.com.generalframework.touzi.XitongMessagesActivity;import friendgoods.vidic.com.generalframework.util.ToastUtils;import static friendgoods.vidic.com.generalframework.MainActivity.Userid;/** * 底部投资页面 */public class ClassificationHome extends BaseFragment {    @BindView(R.id.tab_layout)    TabLayout mTabLayout;    @BindView(R.id.viewpager)    ViewPager mViewpager;    private View view;    private ArrayList<android.support.v4.app.Fragment> mFragments = new ArrayList<>();    private ArrayList<String> list = new ArrayList<>();    Context mContext;    @Override    public void onAttach(Context context) {        super.onAttach(context);        this.mContext=context;    }    @Override    public void onCreate(@Nullable Bundle savedInstanceState) {        super.onCreate(savedInstanceState);    }    @Override    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {        super.onViewCreated(view, savedInstanceState);        initData();        showMessages();        Setsousuo();    }    /**     * 投资搜索     */    @BindView(R.id.navigation_sousuo)    ImageView img_sousuo;    private void Setsousuo(){        img_sousuo.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                Intent intent = new Intent(mContext, TouziSousuoActivity.class);                startActivity(intent);            }        });    }    /**     * 消息     */    @BindView(R.id.touzi_messages)    LinearLayout messages;    private void showMessages(){        messages.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                if (TextUtils.isEmpty(Userid)){//                    ToastUtils.shortToast("请先登录平台");                    Intent intent = new Intent(mContext,LoginActivity.class);                    startActivity(intent);                }else{                    Intent intent  = new Intent(mContext, XitongMessagesActivity.class);                    startActivity(intent);                }            }        });    }    @Nullable    @Override    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {        view = LayoutInflater.from(getActivity()).inflate(R.layout.fragment_classification, null);        ButterKnife.bind(this,view);        return view;    }    private void initData(){        //设置投资页面的里面的6个fragment页面        TouziNewFragment viewpagerNew = new TouziNewFragment();        TouziYugaoFragment viewpagerYugao = new TouziYugaoFragment();        TouziJiudianFragment viewpagerJiudian = new TouziJiudianFragment();        TouziMinsuFragment viewpagerMinsu = new TouziMinsuFragment();        TouziGongyuFragment viewpagerGongyu = new TouziGongyuFragment();        TouziGengduoFragment viewpagerGengduo = new TouziGengduoFragment();        mFragments.add(viewpagerNew);        mFragments.add(viewpagerYugao);        mFragments.add(viewpagerJiudian);        mFragments.add(viewpagerMinsu);        mFragments.add(viewpagerGongyu);        mFragments.add(viewpagerGengduo);        list.add("最新");        list.add("预告");        list.add("酒店");        list.add("民宿");        list.add("公寓");        list.add("更多");        mTabLayout.setupWithViewPager(mViewpager);        mViewpager.setAdapter(new TouziAdapter(getFragmentManager(),mFragments,list));        mTabLayout.post(new Runnable() {            @Override            public void run() {                setIndicator(mTabLayout, 10, 10);            }        });    }    public static void setIndicator(TabLayout tabs, int leftDip, int rightDip) {        Class<?> tabLayout = tabs.getClass();        Field tabStrip = null;        try {            tabStrip = tabLayout.getDeclaredField("mTabStrip");        } catch (NoSuchFieldException e) {            e.printStackTrace();        }        tabStrip.setAccessible(true);        LinearLayout llTab = null;        try {            llTab = (LinearLayout) tabStrip.get(tabs);        } catch (IllegalAccessException e) {            e.printStackTrace();        }        int left = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, leftDip, Resources.getSystem().getDisplayMetrics());        int right = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, rightDip, Resources.getSystem().getDisplayMetrics());        for (int i = 0; i < llTab.getChildCount(); i++) {            View child = llTab.getChildAt(i);            child.setPadding(0, 0, 0, 0);            LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(0, LinearLayout.LayoutParams.MATCH_PARENT, 1);            params.leftMargin = left;            params.rightMargin = right;            child.setLayoutParams(params);            child.invalidate();        }    }}