package friendgoods.vidic.com.generalframework.activity.fragment;import android.content.Context;import android.content.Intent;import android.os.Bundle;import android.support.annotation.NonNull;import android.support.annotation.Nullable;import android.support.v4.app.Fragment;import android.support.v4.app.FragmentPagerAdapter;import android.support.v4.view.ViewPager;import android.text.TextUtils;import android.util.Log;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.ImageView;import android.widget.LinearLayout;import android.widget.ListView;import android.widget.TextView;import com.bumptech.glide.Glide;import com.bumptech.glide.load.engine.DiskCacheStrategy;import com.google.gson.Gson;import com.lzy.okgo.OkGo;import com.lzy.okgo.callback.StringCallback;import com.youth.banner.Banner;import com.youth.banner.BannerConfig;import com.youth.banner.Transformer;import com.youth.banner.loader.ImageLoader;import java.util.ArrayList;import butterknife.BindView;import butterknife.ButterKnife;import friendgoods.vidic.com.generalframework.Bean.JifenShowBean;import friendgoods.vidic.com.generalframework.Bean.LunboBean;import friendgoods.vidic.com.generalframework.Bean.WangqihejiBean;import friendgoods.vidic.com.generalframework.Bean.XiaofeizhongchouBean;import friendgoods.vidic.com.generalframework.MyApplication;import friendgoods.vidic.com.generalframework.R;import friendgoods.vidic.com.generalframework.adapter.XiaofeizhongchouAdapter;import friendgoods.vidic.com.generalframework.faxian.AboutUsActivity;import friendgoods.vidic.com.generalframework.faxian.FaqixiangmuActivity;import friendgoods.vidic.com.generalframework.faxian.FengxiantishiActivity;import friendgoods.vidic.com.generalframework.faxian.GoodsMoreActivity;import friendgoods.vidic.com.generalframework.faxian.JifenShoppingmallActivity;import friendgoods.vidic.com.generalframework.faxian.ShoppingOrderActivity;import friendgoods.vidic.com.generalframework.faxian.ShujupilouActivity;import friendgoods.vidic.com.generalframework.faxian.TuijianActivity;import friendgoods.vidic.com.generalframework.faxian.Wangqiheji2Activity;import friendgoods.vidic.com.generalframework.faxian.WangqihejiActivity;import friendgoods.vidic.com.generalframework.faxian.XiaofeizhongchouActivity;import friendgoods.vidic.com.generalframework.touzi.TouziMoreActivity;import friendgoods.vidic.com.generalframework.util.Api;import friendgoods.vidic.com.generalframework.util.ToastUtils;import okhttp3.Call;import okhttp3.Response;import static friendgoods.vidic.com.generalframework.MainActivity.Userid;/** * 底部发现页面 */public class ShoppingCat extends BaseFragment {    private View view;    Context context;    @Override    public void onAttach(Context context) {        super.onAttach(context);        this.context = context;    }    @Nullable    @Override    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {        view = LayoutInflater.from(getActivity()).inflate(R.layout.fragment_shoppping, null);        ButterKnife.bind(this,view);        return view;    }    @Override    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {        super.onViewCreated(view, savedInstanceState);        initView();        lunbo();        setzhongchou();        setwangqiheji();        showjifenshop();    }    /**     * 展示轮播图     */    @BindView(R.id.banner)    Banner banner;    private ArrayList<String> list_path;    private ArrayList<String> list_title;    private void lunbo(){        //放图片地址的集合        list_path = new ArrayList<>();        //放标题的集合        list_title = new ArrayList<>();        //加载网络图片        OkGo.post(Api.lunbo)                .tag(this)                .execute(new StringCallback() {                    @Override                    public void onError(Call call, Response response, Exception e) {                        super.onError(call, response, e);                        ToastUtils.shortToast("数据信息异常");                    }                    @Override                    public void onSuccess(String s, Call call, Response response) {//                        Log.e("轮播图",s);                        Gson gson = new Gson();                        LunboBean lunboBean = gson.fromJson(s,LunboBean.class);                        if (lunboBean.getState()==1){                            if (lunboBean.getData().size()>0){                                for (int i = 0; i <lunboBean.getData().size() ; i++) {                                    list_path.add(Api.ossurl+lunboBean.getData().get(i).getPhoto());                                }                                //设置内置样式，共有六种可以点入方法内逐一体验使用。                                banner.setBannerStyle(BannerConfig.CIRCLE_INDICATOR);                                //设置图片加载器，图片加载器在下方                                banner.setImageLoader(new MyLoader());                                //设置图片网址或地址的集合                                banner.setImages(list_path);                                //设置轮播的动画效果，内含多种特效，可点入方法内查找后内逐一体验                                banner.setBannerAnimation(Transformer.Default);                                //设置轮播图的标题集合                                banner.setBannerTitles(list_title);                                //设置轮播间隔时间                                banner.setDelayTime(3000);                                //设置是否为自动轮播，默认是“是”。                                banner.isAutoPlay(true);                                //设置指示器的位置，小点点，左中右。                                banner.setIndicatorGravity(BannerConfig.CENTER)                                        //以上内容都可写成链式布局，这是轮播图的监听。比较重要。方法在下面。                                        //必须最后调用的方法，启动轮播图。                                        .start();                            }                        }else{                            ToastUtils.shortToast(lunboBean.getMessage());                        }                    }                });//        list_path.add("http://ww4.sinaimg.cn/large/006uZZy8jw1faic21363tj30ci08ct96.jpg");//        list_path.add("http://ww4.sinaimg.cn/large/006uZZy8jw1faic259ohaj30ci08c74r.jpg");//        list_path.add("http://ww4.sinaimg.cn/large/006uZZy8jw1faic2b16zuj30ci08cwf4.jpg");//        list_path.add("http://ww4.sinaimg.cn/large/006uZZy8jw1faic2e7vsaj30ci08cglz.jpg");//        list_title.add("好好学习");//        list_title.add("天天向上");//        list_title.add("热爱劳动");//        list_title.add("不搞对象");    }    //自定义的图片加载器    private class MyLoader extends ImageLoader {        @Override        public void displayImage(Context context, Object path, ImageView imageView) {            Glide.with(context).load((String) path).into(imageView);        }    }    /**     * 消费众筹     *///    @BindView(R.id.faxian_xiaofeizhongcou)//    ListView lv_xiaofei;    @BindView(R.id.xiaofeizhongchou_img1)    ImageView img1;    @BindView(R.id.xiaofeizhongchou_img2)    ImageView img2;    @BindView(R.id.xiaofeizhongchou_img3)    ImageView img3;    private void setzhongchou(){        OkGo.post(Api.zhongchou)                .tag(this)                .params("page",1)                .params("pageSize",3)                .execute(new StringCallback() {                    @Override                    public void onSuccess(String s, Call call, Response response) {//                        Log.e("消费众筹",s);                        Gson gson = new Gson();                        final XiaofeizhongchouBean xiaofeizhongchouBean = gson.fromJson(s,XiaofeizhongchouBean.class);                        if (xiaofeizhongchouBean.getState()==1){                            if(xiaofeizhongchouBean.getData().getPageInfo().getList().size()>0){                                if (xiaofeizhongchouBean.getData().getPageInfo().getList().size()>0){                                    //先截取需要的网络图片第一张//                                    String[] imgurl = xiaofeizhongchouBean.getData().getPageInfo().getList().get(0).getItems_photo1().split(",");//                                    String shwoimgurl = Api.ossurl + imgurl[0];                                    String shwoimgurl = Api.ossurl + xiaofeizhongchouBean.getData().getPageInfo().getList().get(0).getItems_photo1();                                    Glide.with(context).load(shwoimgurl).into(img1);//                                }                                if(xiaofeizhongchouBean.getData().getPageInfo().getList().size()>1){//                                    String[] imgurl2 = xiaofeizhongchouBean.getData().getPageInfo().getList().get(1).getItems_photo1().split(",");//                                    String shwoimgurl2 = Api.ossurl + imgurl2[0];                                    String shwoimgurl2 = Api.ossurl + xiaofeizhongchouBean.getData().getPageInfo().getList().get(1).getItems_photo1();                                    Glide.with(context).load(shwoimgurl2).into(img2);                                }                                if (xiaofeizhongchouBean.getData().getPageInfo().getList().size()>2){//                                    String[] imgurl3 = xiaofeizhongchouBean.getData().getPageInfo().getList().get(2).getItems_photo1().split(",");                                    String shwoimgurl3 = Api.ossurl + xiaofeizhongchouBean.getData().getPageInfo().getList().get(2).getItems_photo1();//                                    String shwoimgurl3 = Api.ossurl + imgurl3[0];                                    Glide.with(context).load(shwoimgurl3).into(img3);                                }                                img1.setOnClickListener(new View.OnClickListener() {                                    @Override                                    public void onClick(View view) {                                        Intent intent = new Intent(context, TouziMoreActivity.class);                                        intent.putExtra("objid", xiaofeizhongchouBean.getData().getPageInfo().getList().get(0).getItems_number() + "");                                        startActivity(intent);                                    }                                });                                img2.setOnClickListener(new View.OnClickListener() {                                    @Override                                    public void onClick(View view) {                                        Intent intent = new Intent(context, TouziMoreActivity.class);                                        intent.putExtra("objid", xiaofeizhongchouBean.getData().getPageInfo().getList().get(1).getItems_number() + "");                                        startActivity(intent);                                    }                                });                                img3.setOnClickListener(new View.OnClickListener() {                                    @Override                                    public void onClick(View view) {                                        Intent intent = new Intent(context, TouziMoreActivity.class);                                        intent.putExtra("objid", xiaofeizhongchouBean.getData().getPageInfo().getList().get(2).getItems_number() + "");                                        startActivity(intent);                                    }                                });                            }                        }                    }                });    }    /**     * 往期合集     */    @BindView(R.id.xiaofeizhongchou_img4)    ImageView img4;    @BindView(R.id.xiaofeizhongchou_img5)    ImageView img5;    @BindView(R.id.xiaofeizhongchou_img6)    ImageView img6;    @BindView(R.id.xiaofeizhongchou_img7)    ImageView img7;    private void setwangqiheji(){        OkGo.post(Api.wangqiheji)                .tag(this)                .params("page",1)                .params("pageSize",20)                .execute(new StringCallback() {                    @Override                    public void onSuccess(String s, Call call, Response response) {//                        Log.e("往期合集",s);                        Gson gson = new Gson();                        final WangqihejiBean wangqihejiBean =gson.fromJson(s,WangqihejiBean.class);                        if (wangqihejiBean.getState()==1){                            if (wangqihejiBean.getData().getPageInfo().getList().size()>0){                                //先截取需要的网络图片第一张//                                String[] imgurl = wangqihejiBean.getData().getPageInfo().getList().get(0).getItems_photo1().split(",");//                                String shwoimgurl = Api.ossurl + imgurl[0];//                                Glide.with(context).load(shwoimgurl).into(img4);                                String shwoimgurl = Api.ossurl + wangqihejiBean.getData().getPageInfo().getList().get(0).getItems_photo1();                                Glide.with(context)                                        .load(shwoimgurl)                                        .placeholder(R.mipmap.projectshow)                                        .error(R.mipmap.projectshow)                                        .diskCacheStrategy(DiskCacheStrategy.NONE)                                        .into(img4);                            }                            if (wangqihejiBean.getData().getPageInfo().getList().size()>1){//                                String[] imgurl = wangqihejiBean.getData().getPageInfo().getList().get(1).getItems_photo1().split(",");//                                String shwoimgurl = Api.ossurl + imgurl[0];//                                Glide.with(context).load(shwoimgurl).into(img5);                                String shwoimgurl = Api.ossurl + wangqihejiBean.getData().getPageInfo().getList().get(1).getItems_photo1();                                Glide.with(context)                                        .load(shwoimgurl)                                        .placeholder(R.mipmap.projectshow)                                        .error(R.mipmap.projectshow)                                        .diskCacheStrategy(DiskCacheStrategy.NONE)                                        .into(img5);                            }                            if (wangqihejiBean.getData().getPageInfo().getList().size()>2){//                                String[] imgurl = wangqihejiBean.getData().getPageInfo().getList().get(2).getItems_photo1().split(",");//                                String shwoimgurl = Api.ossurl + imgurl[0];//                                Glide.with(context).load(shwoimgurl).into(img6);                                String shwoimgurl = Api.ossurl + wangqihejiBean.getData().getPageInfo().getList().get(2).getItems_photo1();                                Glide.with(context)                                        .load(shwoimgurl)                                        .placeholder(R.mipmap.projectshow)                                        .error(R.mipmap.projectshow)                                        .diskCacheStrategy(DiskCacheStrategy.NONE)                                        .into(img6);                            }                            if (wangqihejiBean.getData().getPageInfo().getList().size()>3){//                                String[] imgurl = wangqihejiBean.getData().getPageInfo().getList().get(3).getItems_photo1().split(",");//                                String shwoimgurl = Api.ossurl + imgurl[0];//                                Glide.with(context).load(shwoimgurl).into(img7);                                String shwoimgurl = Api.ossurl + wangqihejiBean.getData().getPageInfo().getList().get(3).getItems_photo1();                                Glide.with(context)                                        .load(shwoimgurl)                                        .placeholder(R.mipmap.projectshow)                                        .error(R.mipmap.projectshow)                                        .diskCacheStrategy(DiskCacheStrategy.NONE)                                        .into(img7);                            }                            img4.setOnClickListener(new View.OnClickListener() {                                @Override                                public void onClick(View view) {                                    Intent intent = new Intent(context, TouziMoreActivity.class);                                    intent.putExtra("objid", wangqihejiBean.getData().getPageInfo().getList().get(0).getItems_number() + "");                                    startActivity(intent);                                }                            });                            img5.setOnClickListener(new View.OnClickListener() {                                @Override                                public void onClick(View view) {                                    Intent intent = new Intent(context, TouziMoreActivity.class);                                    intent.putExtra("objid", wangqihejiBean.getData().getPageInfo().getList().get(1).getItems_number() + "");                                    startActivity(intent);                                }                            });                            img6.setOnClickListener(new View.OnClickListener() {                                @Override                                public void onClick(View view) {                                    Intent intent = new Intent(context, TouziMoreActivity.class);                                    intent.putExtra("objid", wangqihejiBean.getData().getPageInfo().getList().get(2).getItems_number() + "");                                    startActivity(intent);                                }                            });                            img7.setOnClickListener(new View.OnClickListener() {                                @Override                                public void onClick(View view) {                                    Intent intent = new Intent(context, TouziMoreActivity.class);                                    intent.putExtra("objid", wangqihejiBean.getData().getPageInfo().getList().get(3).getItems_number() + "");                                    startActivity(intent);                                }                            });                        }                    }                });    }    /**     * 推荐项目     * 数据披露     * 风险提示     * 发起项目     * 认识我们     * 消费众筹     * 往期合集     * 积分商城     */    @BindView(R.id.faxian_tuijian)    LinearLayout l_tuijian;    @BindView(R.id.faxian_pilu)    LinearLayout l_pilu;    @BindView(R.id.faxian_fengxiantishi)    LinearLayout l_fengxian;    @BindView(R.id.faxian_faqixiangmu)    LinearLayout l_faqi;    @BindView(R.id.faxian_renshiwomen)    LinearLayout l_renshi;    @BindView(R.id.faxian_xiaofeizhongchou)    LinearLayout l_xiaofeizhongchou;    @BindView(R.id.faxian_wangqiheji)    LinearLayout l_wangqiheji;    @BindView(R.id.faxian_jifenshoppingmall)    LinearLayout ljifenshoppingmall;    private void initView() {        l_tuijian.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                Intent intent = new Intent(getContext(), TuijianActivity.class);                startActivity(intent);            }        });        l_pilu.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                if (TextUtils.isEmpty(Userid)){                    ToastUtils.shortToast("请先登录平台！");                }else{                    Intent intent = new Intent(getContext(), ShujupilouActivity.class);                    startActivity(intent);                }            }        });        l_fengxian.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                Intent intent = new Intent(getContext(), FengxiantishiActivity.class);                startActivity(intent);            }        });        l_faqi.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                if (TextUtils.isEmpty(Userid)){                    ToastUtils.shortToast("请先登录平台！");                }else{                    Intent intent = new Intent(getContext(), FaqixiangmuActivity.class);                    startActivity(intent);                }            }        });        l_renshi.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                Intent intent = new Intent(getContext(), AboutUsActivity.class);                startActivity(intent);            }        });        l_xiaofeizhongchou.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                Intent intent = new Intent(getContext(), XiaofeizhongchouActivity.class);                startActivity(intent);            }        });        l_wangqiheji.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                Intent intent = new Intent(getContext(), Wangqiheji2Activity.class);                startActivity(intent);            }        });        ljifenshoppingmall.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View view) {                if (TextUtils.isEmpty(Userid)){                    ToastUtils.shortToast("请先登录平台！");                }else{                    //积分商城一期隐藏                    Intent intent = new Intent(getContext(), JifenShoppingmallActivity.class);                    startActivity(intent);                }//                ToastUtils.shortToast("敬请期待！");            }        });    }    /**     * 展示积分商城信息     */    @BindView(R.id.jifen_shopimg1)    ImageView img_shop1;    @BindView(R.id.jifen_shopimg2)    ImageView img_shop2;    @BindView(R.id.jifen_shopimg3)    ImageView img_shop3;    @BindView(R.id.jifen_shoptv_1)    TextView tv_1;    @BindView(R.id.jifen_shoptv_2)    TextView tv_2;    @BindView(R.id.jifen_shoptv_3)    TextView tv_3;    @BindView(R.id.shopping_ll1)    LinearLayout ll_show1;    @BindView(R.id.shopping_ll2)    LinearLayout ll_show2;    @BindView(R.id.shopping_ll3)    LinearLayout ll_show3;    private void showjifenshop(){        OkGo.post(Api.jifenshopss)                .tag(this)                .params("page",1)                .params("pageSize",3)                .execute(new StringCallback() {                    @Override                    public void onSuccess(String s, Call call, Response response) {                        Gson gson = new Gson();                        final JifenShowBean jifenShowBean = gson.fromJson(s,JifenShowBean.class);                        if (jifenShowBean.getState()==1){                            if (jifenShowBean.getData()!=null){                                if (jifenShowBean.getData().getPageInfo().getList().size()>0) {                                    Glide.with(context)                                            .load(Api.ossurl + jifenShowBean.getData().getPageInfo().getList().get(0).getPhoto())                                            .placeholder(R.mipmap.projectshow)                                            .error(R.mipmap.projectshow)                                            .diskCacheStrategy(DiskCacheStrategy.NONE)                                            .into(img_shop1);                                    if (jifenShowBean.getData().getPageInfo().getList().get(0).getVoucher().contains(",")){                                        String[] jifen = jifenShowBean.getData().getPageInfo().getList().get(0).getVoucher().split(",");                                        tv_1.setText(jifen[0]+"积分");                                    }else {                                        tv_1.setText(jifenShowBean.getData().getPageInfo().getList().get(0).getVoucher()+"积分");                                    }                                    ll_show1.setOnClickListener(new View.OnClickListener() {                                        @Override                                        public void onClick(View view) {                                            Intent intent = new Intent(context,GoodsMoreActivity.class);                                            intent.putExtra("number",jifenShowBean.getData().getPageInfo().getList().get(0).getNumber());                                            startActivity(intent);                                        }                                    });//                                    tv_1.setText(jifenShowBean.getData().getPageInfo().getList().get(0).getVoucher() + "积分");                                }                                if (jifenShowBean.getData().getPageInfo().getList().size()>1) {                                    Glide.with(context)                                            .load(Api.ossurl + jifenShowBean.getData().getPageInfo().getList().get(1).getPhoto())                                            .placeholder(R.mipmap.projectshow)                                            .error(R.mipmap.projectshow)                                            .diskCacheStrategy(DiskCacheStrategy.NONE)                                            .into(img_shop2);                                    if (jifenShowBean.getData().getPageInfo().getList().get(1).getVoucher().contains(",")){                                        String[] jifen = jifenShowBean.getData().getPageInfo().getList().get(1).getVoucher().split(",");                                        tv_2.setText(jifen[0]+"积分");                                    }else {                                        tv_2.setText(jifenShowBean.getData().getPageInfo().getList().get(1).getVoucher()+"积分");                                    }                                    ll_show2.setOnClickListener(new View.OnClickListener() {                                        @Override                                        public void onClick(View view) {                                            Intent intent = new Intent(context,GoodsMoreActivity.class);                                            intent.putExtra("number",jifenShowBean.getData().getPageInfo().getList().get(1).getNumber());                                            startActivity(intent);                                        }                                    });//                                    tv_2.setText(jifenShowBean.getData().getPageInfo().getList().get(1).getVoucher() + "积分");                                }                                if (jifenShowBean.getData().getPageInfo().getList().size()>2) {                                    Glide.with(context)                                            .load(Api.ossurl + jifenShowBean.getData().getPageInfo().getList().get(2).getPhoto())                                            .placeholder(R.mipmap.projectshow)                                            .error(R.mipmap.projectshow)                                            .diskCacheStrategy(DiskCacheStrategy.NONE)                                            .into(img_shop3);                                    if (jifenShowBean.getData().getPageInfo().getList().get(2).getVoucher().contains(",")){                                        String[] jifen = jifenShowBean.getData().getPageInfo().getList().get(2).getVoucher().split(",");                                        tv_3.setText(jifen[0]+"积分");                                    }else {                                        tv_3.setText(jifenShowBean.getData().getPageInfo().getList().get(2).getVoucher()+"积分");                                    }                                    ll_show3.setOnClickListener(new View.OnClickListener() {                                        @Override                                        public void onClick(View view) {                                            Intent intent = new Intent(context,GoodsMoreActivity.class);                                            intent.putExtra("number",jifenShowBean.getData().getPageInfo().getList().get(2).getNumber());                                            startActivity(intent);                                        }                                    });//                                    tv_3.setText(jifenShowBean.getData().getPageInfo().getList().get(2).getVoucher() + "积分");                                }                            }                        }                    }                });    }}